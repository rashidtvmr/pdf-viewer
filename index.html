<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Native PDF Viewer Timing</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
    }
    #log {
      background: #f0f0f0;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      white-space: pre-wrap;
      font-family: monospace;
    }
    embed {
      width: 100%;
      height: 600px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>PDF Embed with Timing Info</h1>
  <div id="log">Starting test...</div>
  <embed id="pdfEmbed" type="application/pdf" />

  <script>
    const pdfURL = 'https://rashidtvmrpersonalbucket.s3.eu-north-1.amazonaws.com/rashidester2.pdf'; // Change this to your actual PDF path
    const embed = document.getElementById('pdfEmbed');
    const logDiv = document.getElementById('log');

    const log = [];
    const startTime = performance.now();

    function addLog(msg) {
      const t = (performance.now() - startTime).toFixed(2);
      log.push(`[${t}ms] ${msg}`);
      logDiv.textContent = log.join('\n');
    }

    addLog('⏳ PDF load initiated');
    embed.src = pdfURL;

    let renderTimeout;
    let unsupportedTimeout;

    // Detect render success by checking dimensions after short delay
    renderTimeout = setTimeout(() => {
      if (embed.clientHeight > 100 && embed.clientWidth > 100) {
        addLog('✅ PDF appears to have rendered successfully');
      } else {
        addLog('⚠️ Render incomplete or failed to detect rendering visually');
      }
    }, 1000); // Wait 1s after embed to allow rendering

    // Detect failure (unsupported) within 2s if nothing loads
    unsupportedTimeout = setTimeout(() => {
      if (embed.clientHeight === 0 || embed.clientWidth === 0) {
        addLog('❌ Browser does NOT support native PDF viewing');
      } else {
        addLog('✅ Native PDF viewer supported (not perfect, but visible)');
      }
    }, 2000); // 2s wait time before deciding it's unsupported

    // Listen for onerror — rarely fires for PDF, but just in case
    embed.onerror = function () {
      clearTimeout(renderTimeout);
      clearTimeout(unsupportedTimeout);
      addLog('❌ onError: browser failed to load PDF natively');
    };
  </script>
</body>
</html>
